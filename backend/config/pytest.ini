# backend/config/pytest.ini
# Configuration pytest pour les tests unitaires
# Définit les paramètres globaux d'exécution des tests

[pytest]
# Répertoire racine des tests (relatif depuis backend/)
testpaths = tests

# Pattern de découverte des fichiers de tests
python_files = test_*.py

# Pattern de découverte des classes de tests
python_classes = Test*

# Pattern de découverte des fonctions de tests
python_functions = test_*

# Options d'affichage
addopts = 
    # Affichage verbeux
    -v
    # Affichage des print() dans les tests
    -s
    # Arrêt à la première erreur (optionnel, commenter pour exécuter tous les tests)
    # -x
    # Affichage des durées des tests les plus lents
    --durations=10
    # Génération du rapport de couverture
    --cov=.
    --cov-report=html
    --cov-report=term-missing
    # Exclure certains dossiers de la couverture
    --cov-config=config/.coveragerc
    # Désactiver les warnings Python
    -W ignore::DeprecationWarning
    # Couleurs dans le terminal
    --color=yes

# Markers personnalisés (optionnel)
markers =
    unit: Tests unitaires (logique métier)
    integration: Tests d'intégration (DB, API)
    slow: Tests lents (> 1 seconde)
    auth: Tests d'authentification
    crud: Tests CRUD

# Variables d'environnement pour les tests
env =
    ENV=testing
    POSTGRES_DB=bcraftd_test
    SECRET_KEY=test-secret-key-do-not-use-in-production

# Timeout par test (en secondes)
timeout = 30

# Désactiver les warnings pytest
filterwarnings =
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore::DeprecationWarning